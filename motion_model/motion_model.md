# motion_model
車両の運動モデルに基づいて位置と姿勢を計算するプログラムをまとめています。  

## 目次
* [運動モデルとは](#運動モデルとは)
* [四輪モデル](#四輪モデル)
* [二輪モデル](#二輪モデル)

## 運動モデルとは
制御対象である車両の動きを理論的に定式化したものです。車両自身の移動速度や姿勢角速度、ステアリング舵角に応じて、次の時刻における位置と姿勢がどうなるかを予測したり、仮想環境での制御シミュレーションを実施したりするのに利用されます。  
こういった運動モデルを扱うためには、車両の運動学(ビークルダイナミクス)の知識が必要になるので、ここではその基礎を学び、その計算式をPythonで実装出来るようになることを目指します。  

## 四輪モデル
車両の運動モデルとしてまず取り上げられるのは、こちらのような四輪モデルです。  
車両のダイナミクスを考える際は、このような2次元平面の力学、運動学を考えるのが一般的です。  
![](/images/four_wheels_model.png)  

この図の中で定義されている各変数は下記のようになります。  
* $L_f$, $L_r$: 車両の重心位置から前後輪それぞれまでの距離  
* $L$($L_f$+$L_r$): ホイールベース(前後輪間の距離)  
* $d$: トレッド(左右のタイヤ間の距離)
* $V_{fL}$, $V_{fR}$, $V_{rL}$, $V_{rR}$: 前後左右の各タイヤの速度ベクトル  
* $V_b$: 車両の重心位置の速度ベクトル
* $\delta_{fL}$, $\delta_{fR}$: 左右前輪のそれぞれのステアリング舵角
* $\beta_{fL}$, $\beta_{fR}$, $\beta_{rL}$, $\beta_{rR}$: 前後左右の各タイヤのすべり角
* $\beta$: 車両全体のすべり角
* $\dot{\phi}$: 車両方位の角速度
* $CF$: 旋回時に車両にかかる遠心力

このように、前後左右の4つのタイヤにはそれぞれ別々の速度ベクトルやすべり角が生じると考えるのが、四輪モデルの特徴です。

## 二輪モデル
四輪モデルは車両のより細かい動きを表現できる反面、それを実データから解析してモデルとして構築するのが難しいというデメリットもあります。そこで、前後それぞれの左右のタイヤの速度ベクトルやすべり角は同一になると考えることで、モデルをシンプルにするという方法があります。それがこちらの二輪モデルです。  
![](/images/two_wheels_model.png)  

上記の考え方により、左右別々にあったタイヤは一つだとみなすことになり、その形状からBicycle Modelとも呼ばれます。これに伴い、モデルの中で扱う変数の数もかなり少なくなります。  
* $L_f$, $L_r$: 車両の重心位置から前後輪それぞれまでの距離  
* $L$($L_f$+$L_r$): ホイールベース(前後輪間の距離)  
* $V_{r}$, $V_{r}$: 前後のタイヤの速度ベクトル  
* $V_b$: 車両の重心位置の速度ベクトル
* $\delta$: 前輪のそれぞれのステアリング舵角
* $\beta_{f}$, $\beta_{r}$: 前後各タイヤのすべり角
* $\beta$: 車両全体のすべり角
* $\dot{\phi}$: 車両方位の角速度
* $CF$: 旋回時に車両にかかる遠心力

